
var isRecording;;
var recBuf;;
var recTime;;

fun cbrec s = 
    writetcpconn strcatlist "08;"::(strtohex s)::nil;
    /*set recBuf = s::recBuf;
    if recTime + 1000 < time_ms then (
        set recTime = time_ms;
        let Iecholn liststrlen recBuf 0 -> len in
        writetcpconn strcatlist "08;"::(strtohex strcatlist (mkriff recBuf))::"quoicoubeh"::nil;
        set recBuf = nil
    );*/
    0;;

fun recorderHandler data = 
    let rev split data ";" nil nil -> x in
    let atoi hd x -> tp in
        if tp == 0 && isRecording > 0 then (
            // stop
            Secholn "recording stopped";
            recStop
        ) else if tp == 1 && isRecording <= 0 then (
            // start
            Secholn "recording ...";
            set recTime = time_ms;
            recStart 8000 0 #cbrec
        );;
